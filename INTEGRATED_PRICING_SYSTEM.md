# Интегрированная система ценообразования

## Обзор

Интегрированная система ценообразования объединяет несколько источников данных для получения максимально точных и актуальных цен на продукты:

1. **Открытые API** (40% веса) - Росстат, открытые данные, локальные рынки
2. **Краудсорсинг** (30% веса) - данные от пользователей с верификацией
3. **Улучшенные моковые данные** (30% веса) - реалистичные данные с региональными и сезонными факторами

## Компоненты системы

### 1. Открытые API (`src/utils/openDataAPI.js`)

**Функции:**
- Интеграция с Росстатом для получения официальных данных о ценах
- Подключение к открытым источникам данных
- Данные от локальных рынков
- Кэширование для оптимизации запросов

**Особенности:**
- Автоматическое обновление данных
- Региональные различия
- Сезонные колебания
- Высокая достоверность (90%+)

### 2. Краудсорсинг (`src/utils/crowdsourcingPrices.js`)

**Функции:**
- Сбор цен от пользователей
- Система верификации (минимум 3 подтверждения)
- Оценка достоверности данных
- Статистика и аналитика

**Особенности:**
- Пользователи могут добавлять цены вручную, по фото или сканированию чеков
- Система верификации повышает достоверность
- Учет региональных особенностей
- Геймификация для мотивации участия

### 3. Улучшенные моковые данные (`src/utils/enhancedMockData.js`)

**Функции:**
- Реалистичные базовые цены
- Региональные множители
- Сезонные факторы
- Рыночные тренды

**Особенности:**
- 6 регионов с разными ценовыми коэффициентами
- 4 сезона с различными факторами для разных категорий продуктов
- Учет инфляции и рыночных трендов
- Случайные колебания для реалистичности

### 4. Интегрированная система (`src/utils/integratedPricingSystem.js`)

**Функции:**
- Объединение данных из всех источников
- Взвешенное усреднение цен
- Расчет уверенности в результатах
- Рекомендации по ценообразованию

**Алгоритм расчета:**
```javascript
price = Σ(source_price * source_weight * source_confidence) / Σ(source_weight * source_confidence)
```

## UI Компоненты

### 1. PriceCrowdsourcing (`src/components/PriceCrowdsourcing.jsx`)

**Функции:**
- Форма для добавления цен пользователями
- Отображение существующих цен с верификацией
- Статистика краудсорсинга
- Система подтверждения цен

### 2. IntegratedPricingDemo (`src/components/IntegratedPricingDemo.jsx`)

**Функции:**
- Демонстрация всех источников данных
- Сравнение цен из разных источников
- Рекомендации по ценообразованию
- Статистика системы

## Интеграция в ChefMenu

В `ChefMenu.jsx` добавлена новая кнопка "Интегрированная система ценообразования", которая открывает полный интерфейс для:

- Просмотра цен из всех источников
- Добавления данных через краудсорсинг
- Анализа рекомендаций
- Просмотра статистики

## Настройка весов источников

Веса источников можно настроить в `integratedPricingSystem.js`:

```javascript
this.weights = {
  openData: 0.4,      // 40% - официальные данные
  crowdsourcing: 0.3, // 30% - данные пользователей
  mockData: 0.3       // 30% - улучшенные моковые данные
};
```

## Региональные различия

### Поддерживаемые регионы:
- **Москва** (1.3x) - самые высокие цены
- **СПб** (1.2x) - высокие цены
- **Екатеринбург** (1.0x) - средние цены
- **Новосибирск** (0.9x) - ниже среднего
- **Краснодар** (0.95x) - умеренные цены
- **Волгоград** (0.85x) - низкие цены

## Сезонные факторы

### Зима (декабрь-февраль):
- Мясо: +15%
- Рыба: +10%
- Овощи: +30%
- Фрукты: +40%

### Лето (июнь-август):
- Мясо: -5%
- Рыба: -10%
- Овощи: -40%
- Фрукты: -30%

## API Методы

### Получение интегрированной цены:
```javascript
const price = await integratedPricingSystem.getIntegratedPrice(
  'мясо',           // название продукта
  'moscow',         // регион
  {
    useOpenData: true,
    useCrowdsourcing: true,
    useMockData: true,
    fallbackToMock: true
  }
);
```

### Добавление цены через краудсорсинг:
```javascript
crowdsourcingPrices.addUserPrice(
  'мясо',           // продукт
  180,              // цена
  'moscow',         // регион
  {
    userId: 'user123',
    source: 'photo',
    confidence: 0.8
  }
);
```

## Статистика и мониторинг

Система предоставляет детальную статистику:

- Количество запросов к каждому источнику
- Уровень кэширования
- Статистика краудсорсинга
- Средняя уверенность в данных
- Время отклика

## Преимущества системы

1. **Точность** - объединение множественных источников данных
2. **Актуальность** - регулярное обновление через открытые API
3. **Локальность** - учет региональных особенностей
4. **Сезонность** - адаптация к временным факторам
5. **Верификация** - система подтверждения данных пользователей
6. **Прозрачность** - полная видимость источников и уверенности

## Планы развития

1. **Реальные API интеграции** - подключение к настоящим API Росстата
2. **Машинное обучение** - улучшение алгоритмов на основе исторических данных
3. **Мобильное приложение** - упрощение добавления данных через фото
4. **Партнерства** - интеграция с магазинами и поставщиками
5. **Аналитика** - расширенная аналитика и прогнозирование
